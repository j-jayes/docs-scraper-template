Skip to content 

[ ](../.. "Agent Development Kit")

[ Agent Development Kit ](../.. "Agent Development Kit")

Monocle 

Initializing search 




[ adk-python  ](https://github.com/google/adk-python "adk-python") [ adk-js  ](https://github.com/google/adk-js "adk-js") [ adk-go  ](https://github.com/google/adk-go "adk-go") [ adk-java  ](https://github.com/google/adk-java "adk-java")

[ adk-python  ](https://github.com/google/adk-python "adk-python") [ adk-js  ](https://github.com/google/adk-js "adk-js") [ adk-go  ](https://github.com/google/adk-go "adk-go") [ adk-java  ](https://github.com/google/adk-java "adk-java")

  * [ Home  ](../..)

Home 
  * Build Agents  Build Agents 
    * [ Get Started  ](../../get-started/)

Get Started 
      * [ Python  ](../../get-started/python/)
      * [ TypeScript  ](../../get-started/typescript/)
      * [ Go  ](../../get-started/go/)
      * [ Java  ](../../get-started/java/)
    * [ Build your Agent  ](../../tutorials/)

Build your Agent 
      * [ Multi-tool agent  ](../../get-started/quickstart/)
      * [ Agent team  ](../../tutorials/agent-team/)
      * [ Streaming agent  ](../../get-started/streaming/)

Streaming agent 
        * [ Python  ](../../get-started/streaming/quickstart-streaming/)
        * [ Java  ](../../get-started/streaming/quickstart-streaming-java/)
      * [ Visual Builder  ](../../visual-builder/)
      * [ Coding with AI  ](../../tutorials/coding-with-ai/)
      * [ Advanced setup  ](../../get-started/installation/)
    * [ Agents  ](../../agents/)

Agents 
      * [ LLM agents  ](../../agents/llm-agents/)
      * [ Workflow agents  ](../../agents/workflow-agents/)

Workflow agents 
        * [ Sequential agents  ](../../agents/workflow-agents/sequential-agents/)
        * [ Loop agents  ](../../agents/workflow-agents/loop-agents/)
        * [ Parallel agents  ](../../agents/workflow-agents/parallel-agents/)
      * [ Custom agents  ](../../agents/custom-agents/)
      * [ Multi-agent systems  ](../../agents/multi-agents/)
      * [ Agent Config  ](../../agents/config/)
      * [ Models & Authentication  ](../../agents/models/)
    * [ Tools for Agents  ](../../tools/)

Tools for Agents 
      * [ Gemini API tools  ](../../tools/gemini-api/)

Gemini API tools 
        * [ Code Execution  ](../../tools/gemini-api/code-execution/)
        * [ Computer use  ](../../tools/gemini-api/computer-use/)
        * [ Google Search  ](../../tools/gemini-api/google-search/)
      * [ Google Cloud tools  ](../../tools/google-cloud/)

Google Cloud tools 
        * [ Apigee API Hub  ](../../tools/google-cloud/apigee-api-hub/)
        * [ Application Integration  ](../../tools/google-cloud/application-integration/)
        * [ BigQuery  ](../../tools/google-cloud/bigquery/)
        * [ Bigtable  ](../../tools/google-cloud/bigtable/)
        * [ Cloud API Registry  ](../../tools/google-cloud/api-registry/)
        * [ Code Execution with Agent Engine  ](../../tools/google-cloud/code-exec-agent-engine/)
        * [ GKE Code Executor  ](../../tools/google-cloud/gke-code-executor/)
        * [ MCP Toolbox for Databases  ](../../tools/google-cloud/mcp-toolbox-for-databases/)
        * [ RAG Engine  ](../../tools/google-cloud/vertex-ai-rag-engine/)
        * [ Spanner  ](../../tools/google-cloud/spanner/)
        * [ Vertex AI Search  ](../../tools/google-cloud/vertex-ai-search/)
      * [ Third-party tools  ](../../tools/third-party/)

Third-party tools 
        * [ Atlassian  ](../../tools/third-party/atlassian/)
        * [ GitHub  ](../../tools/third-party/github/)
        * [ GitLab  ](../../tools/third-party/gitlab/)
        * [ Hugging Face  ](../../tools/third-party/hugging-face/)
        * [ Linear  ](../../tools/third-party/linear/)
        * [ n8n  ](../../tools/third-party/n8n/)
        * [ Notion  ](../../tools/third-party/notion/)
        * [ PayPal  ](../../tools/third-party/paypal/)
        * [ Qdrant  ](../../tools/third-party/qdrant/)
        * [ Agentic UI (AG-UI)  ](../../tools/third-party/ag-ui/)
      * [ Tool limitations  ](../../tools/limitations/)
    * [ Custom Tools  ](../../tools-custom/)

Custom Tools 
      * Function tools  Function tools 
        * [ Overview  ](../../tools-custom/function-tools/)
        * [ Tool performance  ](../../tools-custom/performance/)
        * [ Action confirmations  ](../../tools-custom/confirmation/)
      * [ MCP tools  ](../../tools-custom/mcp-tools/)
      * [ OpenAPI tools  ](../../tools-custom/openapi-tools/)
      * [ Authentication  ](../../tools-custom/authentication/)
  * Run Agents  Run Agents 
    * [ Agent Runtime  ](../../runtime/)

Agent Runtime 
      * [ Runtime Config  ](../../runtime/runconfig/)
      * [ API Server  ](../../runtime/api-server/)
      * [ Resume Agents  ](../../runtime/resume/)
    * [ Deployment  ](../../deploy/)

Deployment 
      * [ Agent Engine  ](../../deploy/agent-engine/)

Agent Engine 
        * [ Standard deployment  ](../../deploy/agent-engine/deploy/)
        * [ Agent Starter Pack  ](../../deploy/agent-engine/asp/)
        * [ Test deployed agents  ](../../deploy/agent-engine/test/)
      * [ Cloud Run  ](../../deploy/cloud-run/)
      * [ GKE  ](../../deploy/gke/)
    * Observability  Observability 
      * [ Logging  ](../logging/)
      * [ Cloud Trace  ](../cloud-trace/)
      * [ BigQuery Agent Analytics  ](../bigquery-agent-analytics/)
      * [ AgentOps  ](../agentops/)
      * [ Arize AX  ](../arize-ax/)
      * [ Freeplay  ](../freeplay/)
      * [ MLflow  ](../mlflow/)
      * Monocle  [ Monocle  ](./) Table of contents 
        * Overview 
        * Installation 
          * 1\. Install Required Packages 
        * Setup 
          * 1\. Configure Monocle Telemetry 
          * 2\. Configure Exporters (Optional) 
            * Export to Console (for debugging) 
            * Export to Local Files (default) 
        * Observe 
        * Accessing Traces 
        * Visualizing Traces with VS Code Extension 
          * Installation 
          * Features 
          * Usage 
        * What Gets Traced 
        * Support and Resources 
      * [ Phoenix  ](../phoenix/)
      * [ W&B; Weave  ](../weave/)
    * [ Evaluation  ](../../evaluate/)

Evaluation 
      * [ Criteria  ](../../evaluate/criteria/)
      * [ User Simulation  ](../../evaluate/user-sim/)
    * [ Safety and Security  ](../../safety/)

Safety and Security 
  * Components  Components 
    * [ Technical Overview  ](../../get-started/about/)
    * [ Context  ](../../context/)

Context 
      * [ Context caching  ](../../context/caching/)
      * [ Context compression  ](../../context/compaction/)
    * [ Sessions & Memory  ](../../sessions/)

Sessions & Memory 
      * Sessions  Sessions 
        * [ Overview  ](../../sessions/session/)
        * [ Rewind sessions  ](../../sessions/rewind/)
      * [ State  ](../../sessions/state/)
      * [ Memory  ](../../sessions/memory/)
      * [ Vertex AI Express Mode  ](../../sessions/express-mode/)
    * [ Callbacks  ](../../callbacks/)

Callbacks 
      * [ Types of callbacks  ](../../callbacks/types-of-callbacks/)
      * [ Callback patterns  ](../../callbacks/design-patterns-and-best-practices/)
    * [ Artifacts  ](../../artifacts/)

Artifacts 
    * [ Events  ](../../events/)

Events 
    * [ Apps  ](../../apps/)

Apps 
    * [ Plugins  ](../../plugins/)

Plugins 
      * [ Reflect and retry  ](../../plugins/reflect-and-retry/)
    * [ MCP  ](../../mcp/)

MCP 
    * [ A2A Protocol  ](../../a2a/)

A2A Protocol 
      * [ Introduction to A2A  ](../../a2a/intro/)
      * A2A Quickstart (Exposing)  A2A Quickstart (Exposing) 
        * [ Python  ](../../a2a/quickstart-exposing/)
        * [ Go  ](../../a2a/quickstart-exposing-go/)
      * A2A Quickstart (Consuming)  A2A Quickstart (Consuming) 
        * [ Python  ](../../a2a/quickstart-consuming/)
        * [ Go  ](../../a2a/quickstart-consuming-go/)
    * [ Bidi-streaming (live)  ](../../streaming/)

Bidi-streaming (live) 
      * Bidi-streaming development guide series  Bidi-streaming development guide series 
        * [ Part 1. Intro to streaming  ](../../streaming/dev-guide/part1/)
        * [ Part 2. Sending messages  ](../../streaming/dev-guide/part2/)
        * [ Part 3. Event handling  ](../../streaming/dev-guide/part3/)
        * [ Part 4. Run configuration  ](../../streaming/dev-guide/part4/)
        * [ Part 5. Audio, Images, and Video  ](../../streaming/dev-guide/part5/)
      * [ Streaming Tools  ](../../streaming/streaming-tools/)
      * [ Configuring Bidi-streaming behavior  ](../../streaming/configuration/)
    * Grounding  Grounding 
      * [ Understanding Google Search Grounding  ](../../grounding/google_search_grounding/)
      * [ Understanding Vertex AI Search Grounding  ](../../grounding/vertex_ai_search_grounding/)
  * Reference  Reference 
    * [ Release Notes  ](../../release-notes/)
    * [ API Reference  ](../../api-reference/)

API Reference 
      * [ Python ADK  ](../../api-reference/python/)
      * [ Typescript ADK  ](../../api-reference/typescript/)
      * [ Go ADK  ](https://pkg.go.dev/google.golang.org/adk)
      * [ Java ADK  ](../../api-reference/java/)
      * [ CLI Reference  ](../../api-reference/cli/)
      * [ Agent Config Reference  ](../../api-reference/agentconfig/)
      * [ REST API  ](../../api-reference/rest/)
    * [ Community Resources  ](../../community/)
    * [ Contributing Guide  ](../../contributing-guide/)



Table of contents 

  * Overview 
  * Installation 
    * 1\. Install Required Packages 
  * Setup 
    * 1\. Configure Monocle Telemetry 
    * 2\. Configure Exporters (Optional) 
      * Export to Console (for debugging) 
      * Export to Local Files (default) 
  * Observe 
  * Accessing Traces 
  * Visualizing Traces with VS Code Extension 
    * Installation 
    * Features 
    * Usage 
  * What Gets Traced 
  * Support and Resources 



  1. [ Run Agents  ](../../runtime/)
  2. [ Observability  ](../logging/)

[ ](https://github.com/google/adk-docs/edit/main/docs/observability/monocle.md "Edit this page") [ ](https://github.com/google/adk-docs/raw/main/docs/observability/monocle.md "View source of this page")

# Agent Observability with Monocle¶

[Monocle](https://github.com/monocle2ai/monocle) is an open-source observability platform for monitoring, debugging, and improving LLM applications and AI Agents. It provides comprehensive tracing capabilities for your Google ADK applications through automatic instrumentation. Monocle generates OpenTelemetry-compatible traces that can be exported to various destinations including local files or console output.

## Overview¶

Monocle automatically instruments Google ADK applications, allowing you to:

  * **Trace agent interactions** \- Automatically capture every agent run, tool call, and model request with full context and metadata
  * **Monitor execution flow** \- Track agent state, delegation events, and execution flow through detailed traces
  * **Debug issues** \- Analyze detailed traces to quickly identify bottlenecks, failed tool calls, and unexpected agent behavior
  * **Flexible export options** \- Export traces to local files or console for analysis
  * **OpenTelemetry compatible** \- Generate standard OpenTelemetry traces that work with any OTLP-compatible backend



Monocle automatically instruments the following Google ADK components:

  * **`BaseAgent.run_async`** \- Captures agent execution, agent state, and delegation events
  * **`FunctionTool.run_async`** \- Captures tool execution, including tool name, parameters, and results
  * **`Runner.run_async`** \- Captures runner execution, including request context and execution flow



## Installation¶

### 1\. Install Required Packages¶
    
    
    pip install monocle_apptrace google-adk
    

## Setup¶

### 1\. Configure Monocle Telemetry¶

Monocle automatically instruments Google ADK when you initialize telemetry. Simply call `setup_monocle_telemetry()` at the start of your application:
    
    
    from monocle_apptrace import setup_monocle_telemetry
    
    # Initialize Monocle telemetry - automatically instruments Google ADK
    setup_monocle_telemetry(workflow_name="my-adk-app")
    

That's it! Monocle will automatically detect and instrument your Google ADK agents, tools, and runners.

### 2\. Configure Exporters (Optional)¶

By default, Monocle exports traces to local JSON files. You can configure different exporters using environment variables.

#### Export to Console (for debugging)¶

Set the environment variable:
    
    
    export MONOCLE_EXPORTER="console"
    

#### Export to Local Files (default)¶
    
    
    export MONOCLE_EXPORTER="file"
    

Or simply omit the `MONOCLE_EXPORTER` variable - it defaults to `file`.

## Observe¶

Now that you have tracing setup, all Google ADK SDK requests will be automatically traced by Monocle.
    
    
    from monocle_apptrace import setup_monocle_telemetry
    from google.adk.agents import Agent
    from google.adk.runners import InMemoryRunner
    from google.genai import types
    
    # Initialize Monocle telemetry - must be called before using ADK
    setup_monocle_telemetry(workflow_name="weather_app")
    
    # Define a tool function
    def get_weather(city: str) -> dict:
        """Retrieves the current weather report for a specified city.
    
        Args:
            city (str): The name of the city for which to retrieve the weather report.
    
        Returns:
            dict: status and result or error msg.
        """
        if city.lower() == "new york":
            return {
                "status": "success",
                "report": (
                    "The weather in New York is sunny with a temperature of 25 degrees"
                    " Celsius (77 degrees Fahrenheit)."
                ),
            }
        else:
            return {
                "status": "error",
                "error_message": f"Weather information for '{city}' is not available.",
            }
    
    # Create an agent with tools
    agent = Agent(
        name="weather_agent",
        model="gemini-2.0-flash-exp",
        description="Agent to answer questions using weather tools.",
        instruction="You must use the available tools to find an answer.",
        tools=[get_weather]
    )
    
    app_name = "weather_app"
    user_id = "test_user"
    session_id = "test_session"
    runner = InMemoryRunner(agent=agent, app_name=app_name)
    session_service = runner.session_service
    
    await session_service.create_session(
        app_name=app_name,
        user_id=user_id,
        session_id=session_id
    )
    
    # Run the agent (all interactions will be automatically traced)
    async for event in runner.run_async(
        user_id=user_id,
        session_id=session_id,
        new_message=types.Content(role="user", parts=[
            types.Part(text="What is the weather in New York?")]
        )
    ):
        if event.is_final_response():
            print(event.content.parts[0].text.strip())
    

## Accessing Traces¶

By default, Monocle generates traces in JSON files in the local directory `./monocle`. The file name format is:
    
    
    monocle_trace_{workflow_name}_{trace_id}_{timestamp}.json
    

Each trace file contains an array of OpenTelemetry-compatible spans that capture:

  * **Agent execution spans** \- Agent state, delegation events, and execution flow
  * **Tool execution spans** \- Tool name, input parameters, and output results
  * **LLM interaction spans** \- Model calls, prompts, responses, and token usage (if using Gemini or other LLMs)



You can analyze these trace files using any OpenTelemetry-compatible tool or write custom analysis scripts.

## Visualizing Traces with VS Code Extension¶

The [Okahu Trace Visualizer](https://marketplace.visualstudio.com/items?itemName=OkahuAI.okahu-ai-observability) VS Code extension provides an interactive way to visualize and analyze Monocle-generated traces directly in Visual Studio Code.

### Installation¶

  1. Open VS Code
  2. Press `Ctrl+P` (or `Cmd+P` on Mac) to open Quick Open
  3. Paste the following command and press Enter:


    
    
    ext install OkahuAI.okahu-ai-observability
    

Alternatively, you can install it from the [VS Code Marketplace](https://marketplace.visualstudio.com/items?itemName=OkahuAI.okahu-ai-observability).

### Features¶

The extension provides:

  * **Custom Activity Bar Panel** \- Dedicated sidebar for trace file management
  * **Interactive File Tree** \- Browse and select trace files with custom React UI
  * **Split View Analysis** \- Gantt chart visualization alongside JSON data viewer
  * **Real-time Communication** \- Seamless data flow between VS Code and React components
  * **VS Code Theming** \- Fully integrated with VS Code's light/dark themes



### Usage¶

  1. After running your ADK application with Monocle tracing enabled, trace files will be generated in the `./monocle` directory
  2. Open the Okahu Trace Visualizer panel from the VS Code Activity Bar
  3. Browse and select trace files from the interactive file tree
  4. View your traces with:
  5. **Gantt chart visualization** \- See the timeline and hierarchy of spans
  6. **JSON data viewer** \- Inspect detailed span attributes and events
  7. **Token counts** \- View token usage for LLM calls
  8. **Error badges** \- Quickly identify failed operations



## What Gets Traced¶

Monocle automatically captures the following information from Google ADK:

  * **Agent Execution** : Agent state, delegation events, and execution flow
  * **Tool Calls** : Tool name, input parameters, and output results
  * **Runner Execution** : Request context and overall execution flow
  * **Timing Information** : Start time, end time, and duration for each operation
  * **Error Information** : Exceptions and error states



All traces are generated in OpenTelemetry format, making them compatible with any OTLP-compatible observability backend.

## Support and Resources¶

  * [Monocle Documentation](https://docs.okahu.ai/monocle_overview/)
  * [Monocle GitHub Repository](https://github.com/monocle2ai/monocle)
  * [Google ADK Travel Agent Example](https://github.com/okahu-demos/adk-travel-agent)
  * [Discord Community](https://discord.gg/D8vDbSUhJX)



Back to top  [ Previous  MLflow  ](../mlflow/) [ Next  Phoenix  ](../phoenix/)

Copyright Google 2025  |  [Terms](//policies.google.com/terms)  |  [Privacy](//policies.google.com/privacy)  |  Manage cookies

Made with [ Material for MkDocs ](https://squidfunk.github.io/mkdocs-material/)

#### Cookie consent

We use cookies to recognize repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find the information they need. With your consent, you're helping us to make our documentation better.

  * Google Analytics 
  * GitHub 



Accept Manage settings
