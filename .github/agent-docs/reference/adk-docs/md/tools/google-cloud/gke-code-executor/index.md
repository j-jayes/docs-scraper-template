Skip to content 

[ ](../../.. "Agent Development Kit")

[ Agent Development Kit ](../../.. "Agent Development Kit")

GKE Code Executor 

Initializing search 




[ adk-python  ](https://github.com/google/adk-python "adk-python") [ adk-js  ](https://github.com/google/adk-js "adk-js") [ adk-go  ](https://github.com/google/adk-go "adk-go") [ adk-java  ](https://github.com/google/adk-java "adk-java")

[ adk-python  ](https://github.com/google/adk-python "adk-python") [ adk-js  ](https://github.com/google/adk-js "adk-js") [ adk-go  ](https://github.com/google/adk-go "adk-go") [ adk-java  ](https://github.com/google/adk-java "adk-java")

  * [ Home  ](../../..)

Home 
  * Build Agents  Build Agents 
    * [ Get Started  ](../../../get-started/)

Get Started 
      * [ Python  ](../../../get-started/python/)
      * [ TypeScript  ](../../../get-started/typescript/)
      * [ Go  ](../../../get-started/go/)
      * [ Java  ](../../../get-started/java/)
    * [ Build your Agent  ](../../../tutorials/)

Build your Agent 
      * [ Multi-tool agent  ](../../../get-started/quickstart/)
      * [ Agent team  ](../../../tutorials/agent-team/)
      * [ Streaming agent  ](../../../get-started/streaming/)

Streaming agent 
        * [ Python  ](../../../get-started/streaming/quickstart-streaming/)
        * [ Java  ](../../../get-started/streaming/quickstart-streaming-java/)
      * [ Visual Builder  ](../../../visual-builder/)
      * [ Coding with AI  ](../../../tutorials/coding-with-ai/)
      * [ Advanced setup  ](../../../get-started/installation/)
    * [ Agents  ](../../../agents/)

Agents 
      * [ LLM agents  ](../../../agents/llm-agents/)
      * [ Workflow agents  ](../../../agents/workflow-agents/)

Workflow agents 
        * [ Sequential agents  ](../../../agents/workflow-agents/sequential-agents/)
        * [ Loop agents  ](../../../agents/workflow-agents/loop-agents/)
        * [ Parallel agents  ](../../../agents/workflow-agents/parallel-agents/)
      * [ Custom agents  ](../../../agents/custom-agents/)
      * [ Multi-agent systems  ](../../../agents/multi-agents/)
      * [ Agent Config  ](../../../agents/config/)
      * [ Models & Authentication  ](../../../agents/models/)
    * [ Tools for Agents  ](../../)

Tools for Agents 
      * [ Gemini API tools  ](../../gemini-api/)

Gemini API tools 
        * [ Code Execution  ](../../gemini-api/code-execution/)
        * [ Computer use  ](../../gemini-api/computer-use/)
        * [ Google Search  ](../../gemini-api/google-search/)
      * [ Google Cloud tools  ](../)

Google Cloud tools 
        * [ Apigee API Hub  ](../apigee-api-hub/)
        * [ Application Integration  ](../application-integration/)
        * [ BigQuery  ](../bigquery/)
        * [ Bigtable  ](../bigtable/)
        * [ Cloud API Registry  ](../api-registry/)
        * [ Code Execution with Agent Engine  ](../code-exec-agent-engine/)
        * GKE Code Executor  [ GKE Code Executor  ](./) Table of contents 
          * How it Works 
          * Key Benefits 
          * System requirements 
          * Configuration parameters 
        * [ MCP Toolbox for Databases  ](../mcp-toolbox-for-databases/)
        * [ RAG Engine  ](../vertex-ai-rag-engine/)
        * [ Spanner  ](../spanner/)
        * [ Vertex AI Search  ](../vertex-ai-search/)
      * [ Third-party tools  ](../../third-party/)

Third-party tools 
        * [ Atlassian  ](../../third-party/atlassian/)
        * [ GitHub  ](../../third-party/github/)
        * [ GitLab  ](../../third-party/gitlab/)
        * [ Hugging Face  ](../../third-party/hugging-face/)
        * [ Linear  ](../../third-party/linear/)
        * [ n8n  ](../../third-party/n8n/)
        * [ Notion  ](../../third-party/notion/)
        * [ PayPal  ](../../third-party/paypal/)
        * [ Qdrant  ](../../third-party/qdrant/)
        * [ Agentic UI (AG-UI)  ](../../third-party/ag-ui/)
      * [ Tool limitations  ](../../limitations/)
    * [ Custom Tools  ](../../../tools-custom/)

Custom Tools 
      * Function tools  Function tools 
        * [ Overview  ](../../../tools-custom/function-tools/)
        * [ Tool performance  ](../../../tools-custom/performance/)
        * [ Action confirmations  ](../../../tools-custom/confirmation/)
      * [ MCP tools  ](../../../tools-custom/mcp-tools/)
      * [ OpenAPI tools  ](../../../tools-custom/openapi-tools/)
      * [ Authentication  ](../../../tools-custom/authentication/)
  * Run Agents  Run Agents 
    * [ Agent Runtime  ](../../../runtime/)

Agent Runtime 
      * [ Runtime Config  ](../../../runtime/runconfig/)
      * [ API Server  ](../../../runtime/api-server/)
      * [ Resume Agents  ](../../../runtime/resume/)
    * [ Deployment  ](../../../deploy/)

Deployment 
      * [ Agent Engine  ](../../../deploy/agent-engine/)

Agent Engine 
        * [ Standard deployment  ](../../../deploy/agent-engine/deploy/)
        * [ Agent Starter Pack  ](../../../deploy/agent-engine/asp/)
        * [ Test deployed agents  ](../../../deploy/agent-engine/test/)
      * [ Cloud Run  ](../../../deploy/cloud-run/)
      * [ GKE  ](../../../deploy/gke/)
    * Observability  Observability 
      * [ Logging  ](../../../observability/logging/)
      * [ Cloud Trace  ](../../../observability/cloud-trace/)
      * [ BigQuery Agent Analytics  ](../../../observability/bigquery-agent-analytics/)
      * [ AgentOps  ](../../../observability/agentops/)
      * [ Arize AX  ](../../../observability/arize-ax/)
      * [ Freeplay  ](../../../observability/freeplay/)
      * [ MLflow  ](../../../observability/mlflow/)
      * [ Monocle  ](../../../observability/monocle/)
      * [ Phoenix  ](../../../observability/phoenix/)
      * [ W&B; Weave  ](../../../observability/weave/)
    * [ Evaluation  ](../../../evaluate/)

Evaluation 
      * [ Criteria  ](../../../evaluate/criteria/)
      * [ User Simulation  ](../../../evaluate/user-sim/)
    * [ Safety and Security  ](../../../safety/)

Safety and Security 
  * Components  Components 
    * [ Technical Overview  ](../../../get-started/about/)
    * [ Context  ](../../../context/)

Context 
      * [ Context caching  ](../../../context/caching/)
      * [ Context compression  ](../../../context/compaction/)
    * [ Sessions & Memory  ](../../../sessions/)

Sessions & Memory 
      * Sessions  Sessions 
        * [ Overview  ](../../../sessions/session/)
        * [ Rewind sessions  ](../../../sessions/rewind/)
      * [ State  ](../../../sessions/state/)
      * [ Memory  ](../../../sessions/memory/)
      * [ Vertex AI Express Mode  ](../../../sessions/express-mode/)
    * [ Callbacks  ](../../../callbacks/)

Callbacks 
      * [ Types of callbacks  ](../../../callbacks/types-of-callbacks/)
      * [ Callback patterns  ](../../../callbacks/design-patterns-and-best-practices/)
    * [ Artifacts  ](../../../artifacts/)

Artifacts 
    * [ Events  ](../../../events/)

Events 
    * [ Apps  ](../../../apps/)

Apps 
    * [ Plugins  ](../../../plugins/)

Plugins 
      * [ Reflect and retry  ](../../../plugins/reflect-and-retry/)
    * [ MCP  ](../../../mcp/)

MCP 
    * [ A2A Protocol  ](../../../a2a/)

A2A Protocol 
      * [ Introduction to A2A  ](../../../a2a/intro/)
      * A2A Quickstart (Exposing)  A2A Quickstart (Exposing) 
        * [ Python  ](../../../a2a/quickstart-exposing/)
        * [ Go  ](../../../a2a/quickstart-exposing-go/)
      * A2A Quickstart (Consuming)  A2A Quickstart (Consuming) 
        * [ Python  ](../../../a2a/quickstart-consuming/)
        * [ Go  ](../../../a2a/quickstart-consuming-go/)
    * [ Bidi-streaming (live)  ](../../../streaming/)

Bidi-streaming (live) 
      * Bidi-streaming development guide series  Bidi-streaming development guide series 
        * [ Part 1. Intro to streaming  ](../../../streaming/dev-guide/part1/)
        * [ Part 2. Sending messages  ](../../../streaming/dev-guide/part2/)
        * [ Part 3. Event handling  ](../../../streaming/dev-guide/part3/)
        * [ Part 4. Run configuration  ](../../../streaming/dev-guide/part4/)
        * [ Part 5. Audio, Images, and Video  ](../../../streaming/dev-guide/part5/)
      * [ Streaming Tools  ](../../../streaming/streaming-tools/)
      * [ Configuring Bidi-streaming behavior  ](../../../streaming/configuration/)
    * Grounding  Grounding 
      * [ Understanding Google Search Grounding  ](../../../grounding/google_search_grounding/)
      * [ Understanding Vertex AI Search Grounding  ](../../../grounding/vertex_ai_search_grounding/)
  * Reference  Reference 
    * [ Release Notes  ](../../../release-notes/)
    * [ API Reference  ](../../../api-reference/)

API Reference 
      * [ Python ADK  ](../../../api-reference/python/)
      * [ Typescript ADK  ](../../../api-reference/typescript/)
      * [ Go ADK  ](https://pkg.go.dev/google.golang.org/adk)
      * [ Java ADK  ](../../../api-reference/java/)
      * [ CLI Reference  ](../../../api-reference/cli/)
      * [ Agent Config Reference  ](../../../api-reference/agentconfig/)
      * [ REST API  ](../../../api-reference/rest/)
    * [ Community Resources  ](../../../community/)
    * [ Contributing Guide  ](../../../contributing-guide/)



Table of contents 

  * How it Works 
  * Key Benefits 
  * System requirements 
  * Configuration parameters 



  1. [ Build Agents  ](../../../get-started/)
  2. [ Tools for Agents  ](../../)
  3. [ Google Cloud tools  ](../)

[ ](https://github.com/google/adk-docs/edit/main/docs/tools/google-cloud/gke-code-executor.md "Edit this page") [ ](https://github.com/google/adk-docs/raw/main/docs/tools/google-cloud/gke-code-executor.md "View source of this page")

# GKE Code Executor tool for ADK¶

Supported in ADKPython v1.14.0

The GKE Code Executor (`GkeCodeExecutor`) provides a secure and scalable method for running LLM-generated code by leveraging the GKE (Google Kubernetes Engine) Sandbox environment, which uses gVisor for workload isolation. For each code execution request, it dynamically creates an ephemeral, sandboxed Kubernetes Job with a hardened Pod configuration. You should use this executor for production environments on GKE where security and isolation are critical.

## How it Works¶

When a request to execute code is made, the `GkeCodeExecutor` performs the following steps:

  1. **Creates a ConfigMap:** A Kubernetes ConfigMap is created to store the Python code that needs to be executed.
  2. **Creates a Sandboxed Pod:** A new Kubernetes Job is created, which in turn creates a Pod with a hardened security context and the gVisor runtime enabled. The code from the ConfigMap is mounted into this Pod.
  3. **Executes the Code:** The code is executed within the sandboxed Pod, isolated from the underlying node and other workloads.
  4. **Retrieves the Result:** The standard output and error streams from the execution are captured from the Pod's logs.
  5. **Cleans Up Resources:** Once the execution is complete, the Job and the associated ConfigMap are automatically deleted, ensuring that no artifacts are left behind.



## Key Benefits¶

  * **Enhanced Security:** Code is executed in a gVisor-sandboxed environment with kernel-level isolation.
  * **Ephemeral Environments:** Each code execution runs in its own ephemeral Pod, to prevent state transfer between executions.
  * **Resource Control:** You can configure CPU and memory limits for the execution Pods to prevent resource abuse.
  * **Scalability:** Allows you to run a large number of code executions in parallel, with GKE handling the scheduling and scaling of the underlying nodes.



## System requirements¶

The following requirements must be met to successfully deploy your ADK project with the GKE Code Executor tool:

  * GKE cluster with a **gVisor-enabled node pool**.
  * Agent's service account requires specific **RBAC permissions** , which allow it to:
    * Create, watch, and delete **Jobs** for each execution request.
    * Manage **ConfigMaps** to inject code into the Job's pod.
    * List **Pods** and read their **logs** to retrieve the execution result
  * Install the client library with GKE extras: `pip install google-adk[gke]`



For a complete, ready-to-use configuration, see the [deployment_rbac.yaml](https://github.com/google/adk-python/blob/main/contributing/samples/gke_agent_sandbox/deployment_rbac.yaml) sample. For more information on deploying ADK workflows to GKE, see [Deploy to Google Kubernetes Engine (GKE)](/adk-docs/deploy/gke/).

Python
    
    
    from google.adk.agents import LlmAgent
    from google.adk.code_executors import GkeCodeExecutor
    
    # Initialize the executor, targeting the namespace where its ServiceAccount
    # has the required RBAC permissions.
    # This example also sets a custom timeout and resource limits.
    gke_executor = GkeCodeExecutor(
        namespace="agent-sandbox",
        timeout_seconds=600,
        cpu_limit="1000m",  # 1 CPU core
        mem_limit="1Gi",
    )
    
    # The agent now uses this executor for any code it generates.
    gke_agent = LlmAgent(
        name="gke_coding_agent",
        model="gemini-2.0-flash",
        instruction="You are a helpful AI agent that writes and executes Python code.",
        code_executor=gke_executor,
    )
    

## Configuration parameters¶

The `GkeCodeExecutor` can be configured with the following parameters:

Parameter | Type | Description  
---|---|---  
`namespace` | `str` | Kubernetes namespace where the execution Jobs will be created. Defaults to `"default"`.  
`image` | `str` | Container image to use for the execution Pod. Defaults to `"python:3.11-slim"`.  
`timeout_seconds` | `int` | Timeout in seconds for the code execution. Defaults to `300`.  
`cpu_requested` | `str` | Amount of CPU to request for the execution Pod. Defaults to `"200m"`.  
`mem_requested` | `str` | Amount of memory to request for the execution Pod. Defaults to `"256Mi"`.  
`cpu_limit` | `str` | Maximum amount of CPU the execution Pod can use. Defaults to `"500m"`.  
`mem_limit` | `str` | Maximum amount of memory the execution Pod can use. Defaults to `"512Mi"`.  
`kubeconfig_path` | `str` | Path to a kubeconfig file to use for authentication. Falls back to in-cluster config or the default local kubeconfig.  
`kubeconfig_context` | `str` | The `kubeconfig` context to use.  
  
Back to top  [ Previous  Code Execution with Agent Engine  ](../code-exec-agent-engine/) [ Next  MCP Toolbox for Databases  ](../mcp-toolbox-for-databases/)

Copyright Google 2025  |  [Terms](//policies.google.com/terms)  |  [Privacy](//policies.google.com/privacy)  |  Manage cookies

Made with [ Material for MkDocs ](https://squidfunk.github.io/mkdocs-material/)

#### Cookie consent

We use cookies to recognize repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find the information they need. With your consent, you're helping us to make our documentation better.

  * Google Analytics 
  * GitHub 



Accept Manage settings
